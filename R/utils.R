#' Replace the lower right triangle of the matrix with NAs
#'
#' @param matrix Matrix
#' @returns A matrix of the same dimensions, with NAs for all the lower right
#'   entries.
#' @keywords internal
.replace_lower_right_with_NA <- function(matrix) {
  # Get matrix dimensions
  rows <- nrow(matrix)
  cols <- ncol(matrix)

  # Create a copy of the input matrix
  result <- matrix

  # Replace the lower right triangle with NAs
  for (i in 1:rows) {
    for (j in 1:cols) {
      if (i + j > (rows + 1)) {
        # For other rows, replace the lower right triangle with NA
        result[i, j] <- NA
      }
    }
  }

  return(result)
}

#' Check if matrix only contains NAs in the bottom right
#'
#' @param mat Matrix
#'
#' @returns Boolean indicating whether the matrix only contains NAs in the
#'    bottom right (TRUE if only in bottom right, FALSE if elsewhere).
#' @keywords internal
.check_na_bottom_right <- function(mat) {
  # Create a logical mask for valid NA positions
  n_rows <- nrow(mat)
  mask <- matrix(FALSE, nrow = n_rows, ncol = ncol(mat))

  for (i in seq_len(n_rows)) {
    cutoff <- n_rows - i + 1
    if (cutoff < ncol(mat)) {
      mask[i, (cutoff + 1):ncol(mat)] <- TRUE
    }
  }

  # Check if any NAs exist outside valid region
  invalid_nas <- sum(is.na(mat) & !mask)
  return(invalid_nas == 0)
}
