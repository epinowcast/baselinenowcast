<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Mathematical methods for `baselinenowcast` • baselinenowcast</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Mathematical methods for `baselinenowcast`">
<meta name="description" content="Description of mathematical methods used in the package">
<meta property="og:description" content="Description of mathematical methods used in the package">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">baselinenowcast</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.1000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/baselinenowcast.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/baselinenowcast.html">Getting started</a></li>
    <li><a class="dropdown-item" href="../articles/model_definition.html">Mathematical model</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epinowcast/baselinenowcast/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Mathematical methods for `baselinenowcast`</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epinowcast/baselinenowcast/blob/main/vignettes/model_definition.Rmd" class="external-link"><code>vignettes/model_definition.Rmd</code></a></small>
      <div class="d-none name"><code>model_definition.Rmd</code></div>
    </div>

    
    
<div class="section level2" number="1">
<h2 id="overview">
<span class="header-section-number">1</span> Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <code>baselinenowcast</code> model, initially developed as a reference for the COVID-19 hospital admissions nowcasting challenge in Germany (2021-2022, <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1011394" class="external-link">Wolffram et al</a>, utilises reporting triangles of preliminary case counts and their delays. It applies a multiplicative approach, using empirically observed historical delay distributions to estimate yet-to-be-observed cases.
Users can specify whether delay distributions are estimated from the current reporting triangle, fully observed past data, or data from different strata. The model produces point nowcasts by “filling in” the reporting triangle.
Probabilistic nowcasts are generated using a negative binomial model with means from the point nowcast and dispersion parameters estimated from past nowcast errors. These parameters can also be flexibly sourced from current data, historical data, or alternative settings.</p>
<div class="section level3" number="1.1">
<h3 id="notation">
<span class="header-section-number">1.1</span> Notation<a class="anchor" aria-label="anchor" href="#notation"></a>
</h3>
<p>We denote <span class="math inline">\(X_{t,d}, d = 0, .., D\)</span> as the number of cases occurring on time <span class="math inline">\(t\)</span> which appear in the dataset with a delay of <span class="math inline">\(d\)</span>. For example, a delay <span class="math inline">\(d = 0\)</span> means that a case occurring on day <span class="math inline">\(t\)</span> arrived in the dataset on day <span class="math inline">\(t\)</span>, or on what is considered to be the first possible report date in practice. We only consider cases reporting within a maximum delay <span class="math inline">\(D\)</span>. The number of cases reporting for time <span class="math inline">\(t\)</span> with a delay of at most <span class="math inline">\(d\)</span> can be written as:</p>
<p><span class="math display">\[X_{t, \le d} = \sum_{i=0}^d X_{t,i} \]</span></p>
<p>Such that <span class="math inline">\(X_t = X_{t, \le D}\)</span> is the “final” number of reported cases on time <span class="math inline">\(t\)</span>. Conversely, for <span class="math inline">\(d &lt; D\)</span></p>
<p><span class="math display">\[X_{t,&gt;d} = \sum_{i = d+1} ^{D} X_{t,i}\]</span></p>
<p>is the number of cases still missing after <span class="math inline">\(d\)</span> delay. We refer to <span class="math inline">\(X_t\)</span> to describe a random variable, <span class="math inline">\(x_t\)</span> for the corresponding observation, and <span class="math inline">\(\hat{x}_t\)</span> for an estimated/imputed value. The matrix of <span class="math inline">\(x_{t,d}\)</span> available at a given data release time <span class="math inline">\(t^*\)</span> is referred to as the reporting triangle. Here, all <span class="math inline">\(t+d&gt;t^*\)</span> have yet to be observed.</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="14%">
<col width="14%">
<col width="14%">
<col width="14%">
<col width="14%">
<col width="14%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th></th>
<th><span class="math inline">\(d = 0\)</span></th>
<th><span class="math inline">\(d = 1\)</span></th>
<th><span class="math inline">\(d=2\)</span></th>
<th><span class="math inline">\(...\)</span></th>
<th><span class="math inline">\(d= D-1\)</span></th>
<th><span class="math inline">\(d= D\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(t=1\)</span></td>
<td><span class="math inline">\(x_{1,0}\)</span></td>
<td><span class="math inline">\(x_{1,1}\)</span></td>
<td><span class="math inline">\(x_{1,2}\)</span></td>
<td><span class="math inline">\(...\)</span></td>
<td><span class="math inline">\(x_{1,D-1}\)</span></td>
<td><span class="math inline">\(x_{1, D}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(t=2\)</span></td>
<td><span class="math inline">\(x_{2,0}\)</span></td>
<td><span class="math inline">\(x_{2,1}\)</span></td>
<td><span class="math inline">\(x_{2,2}\)</span></td>
<td><span class="math inline">\(...\)</span></td>
<td><span class="math inline">\(x_{2,D-1}\)</span></td>
<td><span class="math inline">\(x_{2, D}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(t=3\)</span></td>
<td><span class="math inline">\(x_{3,0}\)</span></td>
<td><span class="math inline">\(x_{3,1}\)</span></td>
<td><span class="math inline">\(x_{3,2}\)</span></td>
<td><span class="math inline">\(...\)</span></td>
<td><span class="math inline">\(x_{3,D-1}\)</span></td>
<td><span class="math inline">\(x_{3, D}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(...\)</span></td>
<td><span class="math inline">\(...\)</span></td>
<td><span class="math inline">\(...\)</span></td>
<td><span class="math inline">\(...\)</span></td>
<td><span class="math inline">\(...\)</span></td>
<td><span class="math inline">\(...\)</span></td>
<td><span class="math inline">\(...\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(t=t^*-1\)</span></td>
<td><span class="math inline">\(x_{t^*-1,0}\)</span></td>
<td><span class="math inline">\(x_{t^*-1,1}\)</span></td>
<td><span class="math inline">\(x_{t^*-1,,2}\)</span></td>
<td><span class="math inline">\(...\)</span></td>
<td><span class="math inline">\(x_{t^*-1,,D-1}\)</span></td>
<td><span class="math inline">\(x_{t^*-1,D}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(t=t^*\)</span></td>
<td><span class="math inline">\(x_{t^*,0}\)</span></td>
<td><span class="math inline">\(x_{t^*,1}\)</span></td>
<td><span class="math inline">\(x_{t^*,2}\)</span></td>
<td><span class="math inline">\(...\)</span></td>
<td><span class="math inline">\(x_{t^*,D-1}\)</span></td>
<td><span class="math inline">\(x_{t^*, D}\)</span></td>
</tr>
</tbody>
</table>
<p>We refer to the matrix with imputed values for all <span class="math inline">\(t+d&gt;t^*\)</span> as a point nowcast, and the matrix with a complete set of observations for all elements as a complete reporting square.</p>
</div>
</div>
<div class="section level2" number="2">
<h2 id="point-estimate-of-the-delay-distribution">
<span class="header-section-number">2</span> Point estimate of the delay distribution<a class="anchor" aria-label="anchor" href="#point-estimate-of-the-delay-distribution"></a>
</h2>
<div class="section level3" number="2.1">
<h3 id="estimate-of-the-delay-distribution-from-a-complete-reporting-square">
<span class="header-section-number">2.1</span> Estimate of the delay distribution from a complete reporting square<a class="anchor" aria-label="anchor" href="#estimate-of-the-delay-distribution-from-a-complete-reporting-square"></a>
</h3>
<p>We can use a complete reporting square (which can in reality, be rectangular) to compute an empirical estimate of the delay distribution, <span class="math inline">\(\pi(d)\)</span>. The empirical delay distribution, <span class="math inline">\(\pi(d)\)</span> can be computed directly from the completed reporting square <span class="math inline">\(X\)</span></p>
<p><span class="math display">\[
\pi(d)= \frac{\sum_{t=1}^{t=t^*} X_{t,d}}{\sum_{d=0}^{D} \sum_{t=1}^{t=t^*} X_{t,d}}
\]</span></p>
<p>Where the numerator is the sum of all the observations across reference times <span class="math inline">\(t\)</span> for a particular delay <span class="math inline">\(d\)</span>, and the denominator is the sum across all reference times <span class="math inline">\(t\)</span> and delays <span class="math inline">\(d\)</span>.</p>
</div>
<div class="section level3" number="2.2">
<h3 id="estimate-of-the-delay-distribution-from-a-reporting-triangle">
<span class="header-section-number">2.2</span> Estimate of the delay distribution from a reporting triangle<a class="anchor" aria-label="anchor" href="#estimate-of-the-delay-distribution-from-a-reporting-triangle"></a>
</h3>
<p>In the case where we have missing values in the bottom right of the reporting triangle, we need to use the multiplicative model to generate a matrix containing a mixture of observed and imputed values. Then we can compute the delay distribution as described above for the complete reporting square case.</p>
<p>The multiplicative model works by iteratively “filling in” the reporting triangle starting from the bottom left, and moving column by column from left to right until the bottom right of the triangle is filled in.</p>
<div class="float" id="fig1">
<img src="../reference/figures/schematic_fig.png" alt="Visual description of the iterative “completing” of the reporting triangle, moving from left to right and bottom to top. In this cases, we are imputing $x_{t=6, d = 2}$ and $x_{t=5, d= 2}$ assuming that the ratio between $x_{t=1:4, d = 2}$ (block top), and $x_{t=1:4, d=0:1}$ (block top left) holds for for $x_{t=5:6, d = 2}$ (block bottom) and $x_{t=5:6, d = 0:1}$ (block bottom left). In this example, $\hat{x}_{t=6, d = 1}$ has already been imputed using the same approach, and we treat it as known going forward. This process is repeated across the reporting triangle to estimate all values outlined in the dashed lines."><div class="figcaption">Visual description of the iterative “completing” of the reporting triangle, moving from left to right and bottom to top. In this cases, we are imputing $x_{t=6, d = 2}$ and $x_{t=5, d= 2}$ assuming that the ratio between $x_{t=1:4, d = 2}$ (block top), and $x_{t=1:4, d=0:1}$ (block top left) holds for for $x_{t=5:6, d = 2}$ (block bottom) and $x_{t=5:6, d = 0:1}$ (block bottom left). In this example, $\hat{x}_{t=6, d = 1}$ has already been imputed using the same approach, and we treat it as known going forward. This process is repeated across the reporting triangle to estimate all values outlined in the dashed lines.</div>
</div>
<p>The method requires at least one observation, at delay <span class="math inline">\(d=0\)</span> for the most recent reference time, located at the bottom left of the reporting triangle in Figure <a href="#fig1"><strong>??</strong></a> above. The method assumes that the values at each delay <span class="math inline">\(d\)</span> for the recent times, <span class="math inline">\(t\)</span>, will consist of the same proportion of the values previously reported for earlier times <span class="math inline">\(t\)</span>. To fill in the missing values for each column <span class="math inline">\(d\)</span>, we sum over the rectangle of completely observed reference dates for all <span class="math inline">\(d-1\)</span> columns (block top left) and sum over the column of completely observed reference dates for all of the entries in column <span class="math inline">\(d\)</span> (block left). The ratio of these two sums is assumed to be the same in the missing entries in column <span class="math inline">\(d\)</span>, so we use the entries observed up to <span class="math inline">\(d-1\)</span> for each incomplete reference date (block bottom left), and scale by this ratio to get the missing entries in column <span class="math inline">\(d\)</span>. This process is repeated for each delay from <span class="math inline">\(d\)</span> up to the maximum delay <span class="math inline">\(D\)</span>. At each iteration an additional reference time entry is computed as the delay <span class="math inline">\(d\)</span> increases.</p>
<p>The delay distribution is then estimated from the filled in reporting square, using the same algorithm as described above for the case of the complete reporting square.</p>
<p>The <code><a href="../reference/get_delay_estimate.html">get_delay_estimate()</a></code> function ingests either a complete reporting square or a reporting triangle and uses the last <code>n</code> rows to compute an empirical delay probability mass function (returning a simplex vector indexed starting at delay 0).</p>
</div>
</div>
<div class="section level2" number="3">
<h2 id="generation-of-a-point-nowcast-from-a-delay-distribution-and-a-reporting-triangle">
<span class="header-section-number">3</span> Generation of a point nowcast from a delay distribution and a reporting triangle<a class="anchor" aria-label="anchor" href="#generation-of-a-point-nowcast-from-a-delay-distribution-and-a-reporting-triangle"></a>
</h2>
<p>To propagate the point nowcast from the delay distribution, we need to estimate the expected total number of eventual observed cases <span class="math inline">\(\hat{x}_t\)</span>, for each reference time <span class="math inline">\(t\)</span>. Let <span class="math inline">\(z\)</span> be the sum over all delays <span class="math inline">\(d\)</span> that have already been observed (up until <span class="math inline">\(t^*-t\)</span>), such that <span class="math inline">\(z =\sum_{d=1}^{d=t^*-t} x_{t,d}\)</span> and <span class="math inline">\(\delta\)</span> be the cumulative sum of the delay distribution, <span class="math inline">\(\pi(d)\)</span> up until <span class="math inline">\(d = t^*-t\)</span> such that <span class="math inline">\(\delta = \sum_{d=1}^{d=t^*-t} \pi(d)\)</span>. By assuming that <span class="math inline">\(z \sim Bin(x_t, \delta)\)</span> and <span class="math inline">\(x_t \sim Unif(0, \inf)\)</span>, it can be shown that the expected value of <span class="math inline">\(x_t\)</span>, the total number of reported cases on reference time <span class="math inline">\(t\)</span>, can be written as:</p>
<p><span class="math display">\[
E(x_t | z, \delta) = \hat{x}_t = \frac{z + 1 - \delta}{\delta}
\]</span></p>
<p>Then we can compute <span class="math inline">\(\hat{x}_{t,d}\)</span> directly using the <span class="math inline">\(d\)</span>th element of <span class="math inline">\(\pi(d)\)</span></p>
<p><span class="math display">\[
\hat{x}_{t,d} = \pi(d) \times \hat{x}_t
\]</span></p>
<p>Where the number of reports at timepoint <span class="math inline">\(t\)</span> with delay <span class="math inline">\(d\)</span> is the product of the the expected total reports, <span class="math inline">\(\hat{x}_t\)</span> and the proportion expected at that particular delay <span class="math inline">\(d\)</span>, <span class="math inline">\(\pi(d)\)</span>.</p>
<p>The <code><a href="../reference/apply_delay.html">apply_delay()</a></code> function ingests a reporting triangle and a delay PMF and returns a point nowcast.</p>
</div>
<div class="section level2" number="4">
<h2 id="estimate-of-dispersion">
<span class="header-section-number">4</span> Estimate of dispersion<a class="anchor" aria-label="anchor" href="#estimate-of-dispersion"></a>
</h2>
<p>To estimate the uncertainty in the nowcasts, we use past nowcast errors and assume a negative binomial observation model.</p>
<div class="section level3" number="4.1">
<h3 id="generation-of-retrospective-reporting-triangles">
<span class="header-section-number">4.1</span> Generation of retrospective reporting triangles<a class="anchor" aria-label="anchor" href="#generation-of-retrospective-reporting-triangles"></a>
</h3>
<p>We describe a method which generates retrospective reporting triangles to replicate what would have been available as of time <span class="math inline">\(t^*=s^*\)</span>, where <span class="math inline">\(s^* = t^*-m\)</span> for <span class="math inline">\(m = 1, 2, ... M\)</span> to generate <span class="math inline">\(M\)</span> retrospective reporting triangles.</p>
<p>To generate the set of <span class="math inline">\(M\)</span> reporting triangles, we simply remove the last <span class="math inline">\(m\)</span> rows of the existing reporting triangle (or reporting square/rectangle), to generate <span class="math inline">\(M\)</span> truncated partially complete reporting triangles. These can be generated from a reporting triangle or square with the function <code><a href="../reference/truncate_triangles.html">truncate_triangles()</a></code> which ingests a single reporting triangle (or square/rectangle) and returns a list of <code>n</code> truncated triangles containing only observations and missing values if present. We then replace the bottom right triangle of each matrix with NAs, assuming these would not have been observed as of <span class="math inline">\(s^*\)</span>, using the function <code><a href="../reference/generate_triangles.html">generate_triangles()</a></code> which returns a list of <code>n</code> retrospective reporting triangles. The method uses each retrospective reporting triangle to re-estimate a delay distribution using the <span class="math inline">\(N\)</span> preceding rows of the reporting triangle before <span class="math inline">\(s^*\)</span>, and recomputes a retrospective nowcast, for <span class="math inline">\(M\)</span> realizations of the retrospective reporting triangle (so <span class="math inline">\(M\)</span> different <span class="math inline">\(s^*\)</span> values).</p>
</div>
<div class="section level3" number="4.2">
<h3 id="generation-of-retrospective-point-nowcasts">
<span class="header-section-number">4.2</span> Generation of retrospective point nowcasts<a class="anchor" aria-label="anchor" href="#generation-of-retrospective-point-nowcasts"></a>
</h3>
<p>From the <span class="math inline">\(M\)</span> reporting triangles, we apply the method described above to estimate a delay distribution from a reporting triangle and generate a point nowcast for each reporting triangle, to generate <span class="math inline">\(M\)</span> point nowcasts. The function <code><a href="../reference/generate_point_nowcasts.html">generate_point_nowcasts()</a></code> ingests the list of reporting triangles, estimates a delay distribution for each, and generates a set of point nowcasts.</p>
</div>
<div class="section level3" number="4.3">
<h3 id="fit-point-nowcasts-and-observed-values-to-a-negative-binomial-observation-model-at-each-delay">
<span class="header-section-number">4.3</span> Fit point nowcasts and observed values to a negative binomial observation model at each delay<a class="anchor" aria-label="anchor" href="#fit-point-nowcasts-and-observed-values-to-a-negative-binomial-observation-model-at-each-delay"></a>
</h3>
<p>We then take the set of point nowcasts, and the set of truncated partially complete reporting triangles (these do not necessarily contains NAs on the bottom right, the bottom right could be entirely or partially observed). For each delay <span class="math inline">\(d\)</span> we identify the overlapping set of matrix elements that were imputed retrospectively and matrix elements that had been observed as of the most recent time point.</p>
<p>For each delay <span class="math inline">\(d = 1, ..., D\)</span> we assume that the observed values, <span class="math inline">\(X_{s^*-d, &gt;d}\)</span> follow a negative binomial observation model with a mean of <span class="math inline">\(\hat{x}_{s^*-d}\)</span>:</p>
<p><span class="math display">\[
X_{s^*-d,&gt;d} | \hat{x}_{s^*-d, &gt;d}(s*) \sim NegBin(\mu = \hat{x}_{s^*-d} + 0.1, \phi = \phi_d)
\]</span></p>
<p>We add a small number (0.1) to the mean to avoid an ill-defined negative binomial. We note that to perform all these computations, data snapshots from at least <span class="math inline">\(N + M\)</span> past observations, or rows of the original reporting triangle (or square/rectangle), are needed. This estimate of the uncertainty accounts for the empirical uncertainty in the point estimate of the delay distribution over time.</p>
<p>The function <code><a href="../reference/estimate_dispersion.html">estimate_dispersion()</a></code> ingests a list of truncated triangles representing the observations, and the list of point nowcasts, and returns a vector of negative binomial dispersion parameters indexed starting at delay <span class="math inline">\(d = 1\)</span>.</p>
</div>
</div>
<div class="section level2" number="5">
<h2 id="generate-a-probabilistic-nowcast">
<span class="header-section-number">5</span> Generate a probabilistic nowcast<a class="anchor" aria-label="anchor" href="#generate-a-probabilistic-nowcast"></a>
</h2>
<p>Using the dispersion parameters for each delay, <span class="math inline">\(\phi(d),\)</span> for <span class="math inline">\(d = 1,...D\)</span>, we can generate probabilistic nowcasts by drawing samples from the negative binomial:</p>
<p><span class="math display">\[
X_{t,d} \sim NegBin(\mu = \hat{x}_{t,d}, \phi = \phi(d))
\]</span></p>
<p>We can sample for any number of draws, and then use the draws to compute any desired quantiles to summarize the outputs.</p>
<p>The function <code><a href="../reference/add_obs_errors_to_nowcast.html">add_obs_errors_to_nowcast()</a></code> ingests a point nowcast, the dispersion parameters, and the number of draws to sample and generates a list of expected observed point nowcasts. This can then be summarized across delays by passing the list to <code><a href="../reference/nowcast_list_to_df.html">nowcast_list_to_df()</a></code> and summarised by reference time using <code>aggregate_by_ref_time()</code>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kaitlyn Johnson, <a href="https://www.samabbott.co.uk/" class="external-link">Sam Abbott</a>, Johannes Bracher, Sebastian Funk.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
