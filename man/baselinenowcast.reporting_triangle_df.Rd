% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/baselinenowcast.R
\name{baselinenowcast.reporting_triangle_df}
\alias{baselinenowcast.reporting_triangle_df}
\title{Create a dataframe of nowcast results from a reporting_triangle_df}
\usage{
\method{baselinenowcast}{reporting_triangle_df}(
  data,
  scale_factor = 3,
  prop_delay = 0.5,
  output_type = c("samples", "point"),
  draws = 1000,
  uncertainty_model = fit_by_horizon,
  uncertainty_sampler = sample_nb,
  strata_sharing = "none",
  preprocess = preprocess_negative_values,
  ...
)
}
\arguments{
\item{data}{A \link{reporting_triangle_df} object to be nowcasted.}

\item{scale_factor}{Numeric value indicating the multiplicative factor on
the maximum delay to be used for estimation of delay and uncertainty.
Default is \code{3}.}

\item{prop_delay}{Numeric value <1 indicating what proportion of all
reference times in the reporting triangle to be used for delay
estimation. Default is \code{0.5}.}

\item{output_type}{Character string indicating whether the output should be
samples (\code{"samples"})from the estimate with full uncertainty or whether to
return the point estimate (\code{"point"}). Default is \code{"samples"}.}

\item{draws}{Integer indicating the number of probabilistic draws to include
if \code{output_type} is \code{"samples"}. Default is 1000.}

\item{uncertainty_model}{Function that ingests a matrix of observations and a
matrix of predictions and returns a vector that can be used to
apply uncertainty using the same error model. Default is
\code{fit_by_horizon} with arguments of \code{obs} matrix of observations and
\code{pred} the matrix of predictions that fits each column (horizon)
to a negative binomial observation model by default. The user can
specify a different fitting model by replacing the
\code{fit_model} argument in \code{fit_by_horizon}.}

\item{uncertainty_sampler}{Function that ingests a vector or matrix of
predictions and a vector of uncertainty parameters and generates draws
from the observation model. Default is \code{sample_nb} which expects
arguments \code{pred} for the vector of predictions and uncertainty parameters
for the corresponding vector of uncertainty parameters, and draws from a
negative binomial for each element of the vector.}

\item{strata_sharing}{Vector of character strings. Indicates if and what
estimates should be shared for different nowcasting steps. Options are
\code{"none"} for no sharing (each stratum is fully independent),
\code{"delay"} for delay sharing and \code{"uncertainty"} for uncertainty sharing.
Both \code{"delay"} and \code{"uncertainty"} can be passed at the same time.
Default is \code{"none"}.}

\item{preprocess}{Function to apply to the reporting triangle before
estimation, or NULL to skip preprocessing. Default is
\code{\link[=preprocess_negative_values]{preprocess_negative_values()}}, which handles negative values by
redistributing them to earlier delays. Set to NULL if you want to preserve
negative values. Custom preprocess functions must accept a \code{validate}
parameter (defaults to TRUE) to enable validation optimisation in internal
function chains.}

\item{...}{Additional arguments passed to
\code{\link[=estimate_uncertainty]{estimate_uncertainty()}}
and \code{\link[=sample_nowcast]{sample_nowcast()}}.}
}
\value{
Data.frame of class \code{\link{baselinenowcast_df}}
}
\description{
This function ingests a \link{reporting_triangle_df} object and
generates nowcasts in the form of a \link{baselinenowcast_df} object.
This is the recommended entry point for nowcasting with
\code{baselinenowcast}.

This function implements the full nowcasting workflow on single or multiple
reporting triangles, generating estimates of the delay and uncertainty
parameters for all strata using estimates from across strata if specified.
The strata are determined from the \code{reporting_triangle_df} object's
\code{strata} attribute.

\enumerate{
\item \code{\link[=estimate_delay]{estimate_delay()}} - Estimate a delay PMF across strata if
\code{strata_sharing} contains \code{"delay"}
\item \code{\link[=estimate_uncertainty_retro]{estimate_uncertainty_retro()}} - Estimates uncertainty parameters
across strata if \code{strata_sharing} contains \code{"uncertainty"}
\item \code{\link[=as_reporting_triangles]{as_reporting_triangles()}} - Generates a list of reporting
triangle objects from the reporting_triangle_df
\item \code{\link[=baselinenowcast.reporting_triangle]{baselinenowcast.reporting_triangle()}} - Generates point or
probabilistic nowcasts depending on \code{output_type} for each strata.
}
}
\examples{
# Single stratum
data_as_of_df <- syn_nssp_df[syn_nssp_df$report_date <= "2026-04-01", ]
rt_df <- as_reporting_triangle_df(data_as_of_df)
nowcasts <- baselinenowcast(rt_df, draws = 100)

# Multiple strata with shared delay estimation
rt_df_strata <- as_reporting_triangle_df(
  germany_covid19_hosp,
  by = c("age_group", "location")
)
nowcasts_shared <- baselinenowcast(
  rt_df_strata,
  draws = 100,
  strata_sharing = "delay"
)
}
\seealso{
Main nowcasting interface functions
\code{\link{assert_baselinenowcast_df}()},
\code{\link{baselinenowcast}()},
\code{\link{baselinenowcast.data.frame}()},
\code{\link{baselinenowcast.default}()},
\code{\link{baselinenowcast.reporting_triangle}()},
\code{\link{baselinenowcast_df-class}},
\code{\link{new_baselinenowcast_df}()}
}
\concept{baselinenowcast_df}
