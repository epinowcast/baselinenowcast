% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fill_triangles.R
\name{fill_triangles}
\alias{fill_triangles}
\title{Generate retrospective nowcasts}
\usage{
fill_triangles(
  retro_reporting_triangles,
  n = min(sapply(retro_reporting_triangles, nrow)),
  delay_pmf = NULL,
  preprocess = preprocess_negative_values,
  validate = TRUE
)
}
\arguments{
\item{retro_reporting_triangles}{List of \code{n} truncated reporting triangle
matrices with as many rows as available given the truncation.}

\item{n}{Integer indicating the number of reference times
(number of rows) to use to estimate the delay distribution for each
reporting triangle. Default is the minimum of the number of rows of
all the matrices in the \code{list_of_rts}.}

\item{delay_pmf}{Vector or list of vectors of delays assumed to be indexed
starting at the first delay column in each of the matrices in
\code{retro_reporting_triangles}. If a list, must of the same length as
\code{retro_reporting_triangles}, with elements aligning. Default is \code{NULL}}

\item{preprocess}{Function to apply to the truncated triangle before
estimation, or NULL to skip preprocessing. Default is
\code{\link[=preprocess_negative_values]{preprocess_negative_values()}}, which handles negative values by
redistributing them to earlier delays. Set to NULL if you want to preserve
negative PMF entries (e.g., when working with downward corrections where
negative probabilities reflect systematic adjustments). Custom preprocess
functions must accept a \code{validate} parameter (defaults to TRUE) to enable
validation optimisation in internal function chains.}

\item{validate}{Logical. If TRUE (default), validates the object. Set to
FALSE only when called from functions that already validated.}
}
\value{
\code{point_nowcast_matrices} List of the same number of elements as the
input \code{retro_reporting_triangles}but with each reporting triangle filled
in based on the delay estimated in that reporting triangle.
}
\description{
This function ingests a list of incomplete reporting triangles and
generates a list of point nowcast matrices, based on the delay estimated in
each triangle or the corresponding delay passed in. It uses the specified
\code{n} number of reference times to estimate the delay in each retrospective
reporting triangle.
}
\examples{
# Generate retrospective nowcasts using larger triangle
data_as_of <- syn_nssp_df[syn_nssp_df$report_date <= "2026-04-01", ]
rep_tri <- as_reporting_triangle(data_as_of) |>
  truncate_to_delay(max_delay = 25) |>
  tail(n = 50)
trunc_rts <- truncate_triangles(rep_tri, n = 2)
retro_rts <- apply_reporting_structures(trunc_rts)
retro_pt_nowcast_mat_list <- fill_triangles(retro_rts, n = 30)
retro_pt_nowcast_mat_list[1:2]
}
\seealso{
Point nowcast generation functions
\code{\link{apply_delay}()},
\code{\link{fill_triangle}()}
}
\concept{generate_point_nowcasts}
