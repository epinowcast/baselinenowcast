<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generate a single draw of a nowcast combining observed and predicted values — sample_nowcast • baselinenowcast</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate a single draw of a nowcast combining observed and predicted values — sample_nowcast"><meta name="description" content="Generate a single draw of a nowcast combining observed and predicted values"><meta property="og:description" content="Generate a single draw of a nowcast combining observed and predicted values"><meta property="og:image" content="https://baselinenowcast.epinowcast.org/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">baselinenowcast</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/baselinenowcast.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/baselinenowcast.html">Getting started</a></li>
    <li><a class="dropdown-item" href="../articles/modular_workflow.html">Modular workflow demonstration</a></li>
    <li><a class="dropdown-item" href="../articles/model_definition.html">Mathematical model</a></li>
    <li><a class="dropdown-item" href="../articles/nomenclature.html">Nomenclature</a></li>
    <li><a class="dropdown-item" href="../articles/nssp_nowcast.html">A case study nowcasting applied to the U.S. National Syndromic Surveillance Program (NSSP) data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epinowcast/baselinenowcast/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generate a single draw of a nowcast combining observed and predicted values</h1>
      <small class="dont-index">Source: <a href="https://github.com/epinowcast/baselinenowcast/blob/main/R/sample_predictions.R" class="external-link"><code>R/sample_predictions.R</code></a></small>
      <div class="d-none name"><code>sample_nowcast.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generate a single draw of a nowcast combining observed and predicted values</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sample_nowcast</span><span class="op">(</span></span>
<span>  <span class="va">point_nowcast_matrix</span>,</span>
<span>  <span class="va">reporting_triangle</span>,</span>
<span>  <span class="va">uncertainty_params</span>,</span>
<span>  uncertainty_sampler <span class="op">=</span> <span class="va">sample_nb</span>,</span>
<span>  ref_time_aggregator <span class="op">=</span> <span class="va">identity</span>,</span>
<span>  delay_aggregator <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-point-nowcast-matrix">point_nowcast_matrix<a class="anchor" aria-label="anchor" href="#arg-point-nowcast-matrix"></a></dt>
<dd><p>Matrix of point nowcast predictions and
observations, with rows representing the reference times and columns
representing the delays.</p></dd>


<dt id="arg-reporting-triangle">reporting_triangle<a class="anchor" aria-label="anchor" href="#arg-reporting-triangle"></a></dt>
<dd><p>A <a href="reporting_triangle-class.html">reporting_triangle</a> object with rows
representing reference times and columns representing delays.
Can be a reporting matrix or incomplete reporting matrix.
Can also be a ragged reporting triangle, where multiple columns are
reported for the same row (e.g., weekly reporting of daily data).</p></dd>


<dt id="arg-uncertainty-params">uncertainty_params<a class="anchor" aria-label="anchor" href="#arg-uncertainty-params"></a></dt>
<dd><p>Vector of uncertainty parameters ordered from
horizon 1 to the maximum horizon. Note that these will be reversed
internally to match the ordering of the <code>point_nowcast_matrix</code> (where
a horizon of 1 is the last entry).</p></dd>


<dt id="arg-uncertainty-sampler">uncertainty_sampler<a class="anchor" aria-label="anchor" href="#arg-uncertainty-sampler"></a></dt>
<dd><p>Function that ingests a vector or matrix of
predictions and a vector of uncertainty parameters and generates draws
from the observation model. Default is <code>sample_nb</code> which expects
arguments <code>pred</code> for the vector of predictions and uncertainty parameters
for the corresponding vector of uncertainty parameters, and draws from a
negative binomial for each element of the vector.</p></dd>


<dt id="arg-ref-time-aggregator">ref_time_aggregator<a class="anchor" aria-label="anchor" href="#arg-ref-time-aggregator"></a></dt>
<dd><p>Function that operates along the rows (reference
times) of the retrospective point nowcast matrix before it has been
aggregated across columns (delays). Default is <code>identity</code>
which does not aggregate across reference times.</p></dd>


<dt id="arg-delay-aggregator">delay_aggregator<a class="anchor" aria-label="anchor" href="#arg-delay-aggregator"></a></dt>
<dd><p>Function that operates along the columns (delays)
of the retrospective point nowcast matrix after it has been aggregated
across reference times. Default is <code>function(x) rowSums(x, na.rm = TRUE)</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Vector of predicted counts at each reference date based on combining
the observed counts and the predicted counts for the unobserved elements.
Returns values for all reference dates in the input <code>reporting_triangle</code>
(or fewer if using <code>ref_time_aggregator</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Probabilistic nowcast generation functions
<code><a href="combine_obs_with_pred.html">combine_obs_with_pred()</a></code>,
<code><a href="sample_nb.html">sample_nb()</a></code>,
<code><a href="sample_nowcasts.html">sample_nowcasts()</a></code>,
<code><a href="sample_prediction.html">sample_prediction()</a></code>,
<code><a href="sample_predictions.html">sample_predictions()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Generate point nowcast and uncertainty params from example data</span></span></span>
<span class="r-in"><span><span class="va">data_as_of</span> <span class="op">&lt;-</span> <span class="va">syn_nssp_df</span><span class="op">[</span><span class="va">syn_nssp_df</span><span class="op">$</span><span class="va">report_date</span> <span class="op">&lt;=</span> <span class="st">"2026-04-01"</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">rep_tri</span> <span class="op">&lt;-</span> <span class="fu"><a href="as_reporting_triangle.html">as_reporting_triangle</a></span><span class="op">(</span><span class="va">data_as_of</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="truncate_to_delay.html">truncate_to_delay</a></span><span class="op">(</span>max_delay <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Using max_delay = 154 from data</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Truncating from max_delay = 154 to 5.</span>
<span class="r-in"><span><span class="va">point_nowcast_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="estimate_and_apply_delay.html">estimate_and_apply_delay</a></span><span class="op">(</span><span class="va">rep_tri</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">reporting_triangle</span> <span class="op">&lt;-</span> <span class="fu"><a href="apply_reporting_structure.html">apply_reporting_structure</a></span><span class="op">(</span><span class="va">rep_tri</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">uncertainty_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="estimate_uncertainty_retro.html">estimate_uncertainty_retro</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">rep_tri</span>,</span></span>
<span class="r-in"><span>  n_history_delay <span class="op">=</span> <span class="fl">8</span>,</span></span>
<span class="r-in"><span>  n_retrospective_nowcasts <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nowcast_draw</span> <span class="op">&lt;-</span> <span class="fu">sample_nowcast</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">point_nowcast_matrix</span>,</span></span>
<span class="r-in"><span>  <span class="va">reporting_triangle</span>,</span></span>
<span class="r-in"><span>  <span class="va">uncertainty_params</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nowcast_draw</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             459</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2026-03-28  402</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2026-03-29  603</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2026-03-30  570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2026-03-31  563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2026-04-01  502</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kaitlyn Johnson, Emily Tyszka, Johannes Bracher, Sebastian Funk, <a href="https://www.samabbott.co.uk/" class="external-link">Sam Abbott</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.9000.</p>
</div>

    </footer></div>





  </body></html>

